<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>配置SSH免密码登录服务器</title>
    <url>/2020/03/02/%E9%85%8D%E7%BD%AESSH%E5%85%8D%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="SSH免密码登录服务器"><a href="#SSH免密码登录服务器" class="headerlink" title="SSH免密码登录服务器"></a><center>SSH免密码登录服务器</center></h1><h2 id="1-Windows端免密登录服务器"><a href="#1-Windows端免密登录服务器" class="headerlink" title="1.Windows端免密登录服务器"></a>1.Windows端免密登录服务器</h2><p><font size="4">准备：<br>    　服务端：RHEL 7<br>    　客户端：Windows 10</font></p>
<h3 id="1-客户端生成公钥"><a href="#1-客户端生成公钥" class="headerlink" title="1).客户端生成公钥"></a>1).客户端生成公钥</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\WL&gt;ssh-keygen</span><br><span class="line"></span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (C:\Users\WL/.ssh/id_rsa):   //直接按enter</span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase):		 				 //直接按enter		</span><br><span class="line">Enter same passphrase again:									 //直接按enter</span><br><span class="line">Your identification has been saved <span class="keyword">in</span> C:\Users\WL/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> C:\Users\WL/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:D6h2HwH88Y0KJh2bxb9IgSMvftzh3U+e2py29cYoZnE wl@乐少</span><br><span class="line">The key<span class="string">'s randomart image is:</span></span><br><span class="line"><span class="string">+---[RSA 2048]----+</span></span><br><span class="line"><span class="string">|                 |</span></span><br><span class="line"><span class="string">|     . o         |</span></span><br><span class="line"><span class="string">|    . * =        |</span></span><br><span class="line"><span class="string">|     + X = o     |</span></span><br><span class="line"><span class="string">|    o O S + .    |</span></span><br><span class="line"><span class="string">|   . * = O o. E  |</span></span><br><span class="line"><span class="string">|    + + * + .o.o.|</span></span><br><span class="line"><span class="string">|   . o . .  +*o++|</span></span><br><span class="line"><span class="string">|        .  o.+Oo.|</span></span><br><span class="line"><span class="string">+----[SHA256]-----+</span></span><br></pre></td></tr></table></figure></div>
<h3 id="2-将生成公钥传送到服务器"><a href="#2-将生成公钥传送到服务器" class="headerlink" title="2).将生成公钥传送到服务器"></a>2).将生成公钥传送到服务器</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\WL&gt;scp C:\Users\WL\.ssh\id_rsa.pub root@49.234.76.76:\root\</span><br><span class="line">root@192.168.3.3<span class="string">'s password:</span></span><br><span class="line"><span class="string">id_rsa.pub                                                       100%  390   109.6KB/s   00:00</span></span><br></pre></td></tr></table></figure></div>
<h3 id="3-服务器端将公钥追加到anthorized-keys文件"><a href="#3-服务器端将公钥追加到anthorized-keys文件" class="headerlink" title="3).服务器端将公钥追加到anthorized_keys文件"></a>3).服务器端将公钥追加到anthorized_keys文件</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[18:05:04 root@RHEL~]<span class="comment"># cat id_rsa.pub &gt;/root/.ssh/authorized_keys</span></span><br></pre></td></tr></table></figure></div>
<h3 id="4-客户端登录测试"><a href="#4-客户端登录测试" class="headerlink" title="4).客户端登录测试"></a>4).客户端登录测试</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\WL&gt;ssh root@49.234.76.76</span><br><span class="line">Last login: Mon Mar  2 17:46:53 2020 from 192.168.3.1</span><br><span class="line">[18:06:08 root@RHEL~]<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>
<h2 id="2-Linux端免秘钥登录服务器"><a href="#2-Linux端免秘钥登录服务器" class="headerlink" title="2.Linux端免秘钥登录服务器"></a>2.Linux端免秘钥登录服务器</h2><p><font size="4">准备：<br>    　客户端：CentOS 7<br>    　服务端：RHEL 7</font></p>
<h3 id="1-客户端生成公钥-1"><a href="#1-客户端生成公钥-1" class="headerlink" title="1).客户端生成公钥"></a>1).客户端生成公钥</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[18:09:29 root@localhost ~]$ ssh-keygen</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/root/.ssh/id_rsa): 			//直接按enter</span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase): 						//直接按enter</span><br><span class="line">Enter same passphrase again: 										//直接按enter</span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:37Y1g2lUyBIlhKBaiLpIbklSFFO/gLED3sHSquXfTK0 root@yc</span><br><span class="line">The key<span class="string">'s randomart image is:</span></span><br><span class="line"><span class="string">+---[RSA 2048]----+</span></span><br><span class="line"><span class="string">|. B+. .. o+..    |</span></span><br><span class="line"><span class="string">|.=.O.o  .  + .   |</span></span><br><span class="line"><span class="string">|..O.+ .   . o .  |</span></span><br><span class="line"><span class="string">|.o.+ . .   . .   |</span></span><br><span class="line"><span class="string">|+=.   ..S   .    |</span></span><br><span class="line"><span class="string">|B.o   . .. o o   |</span></span><br><span class="line"><span class="string">|o+ . + .  . * +  |</span></span><br><span class="line"><span class="string">|.   . E    o o o |</span></span><br><span class="line"><span class="string">|            .    |</span></span><br><span class="line"><span class="string">+----[SHA256]-----+</span></span><br></pre></td></tr></table></figure></div>

<h3 id="2-客户端密钥传送给服务器"><a href="#2-客户端密钥传送给服务器" class="headerlink" title="2).客户端密钥传送给服务器"></a>2).客户端密钥传送给服务器</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[18:14:49 root@localhost~]<span class="comment"># ssh-copy-id root@49.234.76.76			//此命令可以直接让服务器记住公钥</span></span><br><span class="line">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: <span class="string">"/root/.ssh/id_rsa.pub"</span></span><br><span class="line">/usr/bin/ssh-copy-id: INFO: attempting to <span class="built_in">log</span> <span class="keyword">in</span> with the new key(s), to filter out any that are already installed</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- <span class="keyword">if</span> you are prompted now it is to install the new keys</span><br><span class="line">root@49.234.76.76<span class="string">'s password: </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Number of key(s) added: 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Now try logging into the machine, with:   "ssh '</span>root@49.234.76.76<span class="string">'"</span></span><br><span class="line"><span class="string">and check to make sure that only the key(s) you wanted were added.</span></span><br></pre></td></tr></table></figure></div>
<h3 id="3-客户端测试"><a href="#3-客户端测试" class="headerlink" title="3).客户端测试"></a>3).客户端测试</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[18:15:25 root@localhost~]<span class="comment">#ssh 49.234.76.76</span></span><br><span class="line">Last failed login: Mon Mar  2 18:15:51 CST 2020 from 49.233.197.180 on ssh:notty</span><br><span class="line">There were 1558 failed login attempts since the last successful login.</span><br><span class="line">Last login: Mon Mar  2 17:17:51 2020 from 171.41.38.113</span><br><span class="line">[18:15:52 root@REHL ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<h1 id="成功！！！"><a href="#成功！！！" class="headerlink" title="成功！！！"></a>成功！！！</h1>]]></content>
  </entry>
  <entry>
    <title>路由交换—Vlan间路由</title>
    <url>/2020/02/29/%E8%B7%AF%E7%94%B1%E4%BA%A4%E6%8D%A2%E2%80%94Vlan%E9%97%B4%E8%B7%AF%E7%94%B1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="VLAN间路由"><a href="#VLAN间路由" class="headerlink" title="VLAN间路由"></a><center>VLAN间路由</center></h1><p><font size="4">通过网络层设备根据IP地址为VLAN间执行路由转发的操作称为VLAN间路由。</font></p>
<h2 id="VLAN间路由的三种方法："><a href="#VLAN间路由的三种方法：" class="headerlink" title="VLAN间路由的三种方法："></a>VLAN间路由的三种方法：</h2><p><font size="4">1.传统VLAN间路由环境<br>2.单臂路由<br>3.三层交换机VLAN间路由</font></p>
<h2 id="1-传统VLAN间路由环境"><a href="#1-传统VLAN间路由环境" class="headerlink" title="1.传统VLAN间路由环境"></a>1.传统VLAN间路由环境</h2><p><font size="4">使用路由器作为数据转发设备，每个VLAN对应路由器和交换机一个接口</font></p>
<h3 id="1-建立拓扑"><a href="#1-建立拓扑" class="headerlink" title="1).建立拓扑"></a>1).建立拓扑</h3><p><a href="https://img-blog.csdnimg.cn/20200229174731332.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200229174731332.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a></p>
<h3 id="2-设置PC1-PC2的ip地址和网关"><a href="#2-设置PC1-PC2的ip地址和网关" class="headerlink" title="2).设置PC1,PC2的ip地址和网关"></a>2).设置PC1,PC2的ip地址和网关</h3><p>PC1<br><a href="https://img-blog.csdnimg.cn/20200229174837585.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200229174837585.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a>PC2<br><a href="https://img-blog.csdnimg.cn/2020022917504995.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/2020022917504995.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a></p>
<h3 id="3-配置交换机"><a href="#3-配置交换机" class="headerlink" title="3).配置交换机"></a>3).配置交换机</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[sw1]vlan batch 10 20				//同时建立两个VLAN</span><br><span class="line">[sw1]interface g0/0/1</span><br><span class="line">[sw1-GigabitEthernet0/0/1]port link-type access 		//链路类型为access</span><br><span class="line">[sw1-GigabitEthernet0/0/1]port default vlan 10</span><br><span class="line">[sw1-GigabitEthernet0/0/1]quit</span><br><span class="line">[sw1]interface g0/0/2</span><br><span class="line">[sw1-GigabitEthernet0/0/2]port link-type access </span><br><span class="line">[sw1-GigabitEthernet0/0/2]port default vlan 20</span><br><span class="line">[sw1-GigabitEthernet0/0/2]quit</span><br><span class="line">[sw1]interface g0/0/5</span><br><span class="line">[sw1-GigabitEthernet0/0/5]port link-type access </span><br><span class="line">[sw1-GigabitEthernet0/0/5]port default vlan 10</span><br><span class="line">[sw1-GigabitEthernet0/0/5]quit</span><br><span class="line">[sw1]interface g0/0/6</span><br><span class="line">[sw1-GigabitEthernet0/0/6]port link-type access </span><br><span class="line">[sw1-GigabitEthernet0/0/6]port default vlan 20</span><br><span class="line">[sw1-GigabitEthernet0/0/6]quit</span><br></pre></td></tr></table></figure></div>
<h3 id="4-配置路由器"><a href="#4-配置路由器" class="headerlink" title="4).配置路由器"></a>4).配置路由器</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[AR1]interface g0/0/0</span><br><span class="line">[AR1-GigabitEthernet0/0/0]ip address 192.168.10.254 24</span><br><span class="line">[AR1-GigabitEthernet0/0/0]quit</span><br><span class="line">[AR1]interface g0/0/1</span><br><span class="line">[AR1-GigabitEthernet0/0/1]ip address 192.168.20.254 24</span><br><span class="line">[AR1-GigabitEthernet0/0/1]quit</span><br></pre></td></tr></table></figure></div>
<h3 id="5-测试"><a href="#5-测试" class="headerlink" title="5).测试"></a>5).测试</h3><p><a href="https://img-blog.csdnimg.cn/20200229180756853.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200229180756853.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a><br><a href="https://img-blog.csdnimg.cn/20200229180817574.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200229180817574.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a></p>
<h2 id="2-单臂路由"><a href="#2-单臂路由" class="headerlink" title="2.单臂路由"></a>2.单臂路由</h2><p><font size="4">交换机和路由器只有一个物理接口相连，交换机接口所有数据通过这个接口转发，通过逻辑的方式，将一个物理接口划分为多个逻辑接口</font></p>
<h3 id="1-建立拓扑-1"><a href="#1-建立拓扑-1" class="headerlink" title="1).建立拓扑"></a>1).建立拓扑</h3><p><a href="https://img-blog.csdnimg.cn/20200229182754789.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200229182754789.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a></p>
<h3 id="2-配置PC1-PC2的ip地址"><a href="#2-配置PC1-PC2的ip地址" class="headerlink" title="2).配置PC1,PC2的ip地址"></a>2).配置PC1,PC2的ip地址</h3><p>PC1<br><a href="https://img-blog.csdnimg.cn/20200229182938986.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200229182938986.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a><br>PC2<br><a href="https://img-blog.csdnimg.cn/20200229183001753.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200229183001753.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a></p>
<h3 id="3-配置交换机-1"><a href="#3-配置交换机-1" class="headerlink" title="3).配置交换机"></a>3).配置交换机</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[sw1]vlan batch 10 20</span><br><span class="line">[sw1]interface g0/0/2</span><br><span class="line">[sw1-GigabitEthernet0/0/2]port link-type access </span><br><span class="line">[sw1-GigabitEthernet0/0/2]port default vlan 10</span><br><span class="line">[sw1-GigabitEthernet0/0/2]quit</span><br><span class="line">[sw1]interface g0/0/3</span><br><span class="line">[sw1-GigabitEthernet0/0/3]port link-type access </span><br><span class="line">[sw1-GigabitEthernet0/0/3]port default vlan 20</span><br><span class="line">[sw1-GigabitEthernet0/0/3]quit</span><br><span class="line">[sw1]interface g0/0/5</span><br><span class="line">[sw1-GigabitEthernet0/0/5]port link-type trunk</span><br><span class="line">[sw1-GigabitEthernet0/0/5]port trunk allow-pass vlan 10 20</span><br></pre></td></tr></table></figure></div>
<h3 id="4-配置路由器-1"><a href="#4-配置路由器-1" class="headerlink" title="4).配置路由器"></a>4).配置路由器</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[AR1]interface g0/0/0.10</span><br><span class="line">[AR1-GigabitEthernet0/0/0.10]ip address 192.168.10.254			//给vlan添加地址</span><br><span class="line">[AR1-GigabitEthernet0/0/0.10]dot1q termination vid 10			//封装并且指定了端口的PVID</span><br><span class="line">[AR1-GigabitEthernet0/0/0.10]arp broadcast <span class="built_in">enable</span>				//启用子接口的ARP广播功能</span><br><span class="line">[AR1-GigabitEthernet0/0/0.10]quit							</span><br><span class="line">[AR1]interface g0/0/0.20</span><br><span class="line">[AR1-GigabitEthernet0/0/0.20]ip address 192.168.20.254 24</span><br><span class="line">[AR1-GigabitEthernet0/0/0.20]dot1q termination vid 20</span><br><span class="line">[AR1-GigabitEthernet0/0/0.20]arp broadcast <span class="built_in">enable</span></span><br></pre></td></tr></table></figure></div>
<h3 id="5-测试-1"><a href="#5-测试-1" class="headerlink" title="5).测试"></a>5).测试</h3><p><a href="https://img-blog.csdnimg.cn/20200229214617693.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200229214617693.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a><br><a href="https://img-blog.csdnimg.cn/20200229214830571.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200229214830571.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a></p>
<h2 id="3-三层交换机VLAN间路由配置"><a href="#3-三层交换机VLAN间路由配置" class="headerlink" title="3.三层交换机VLAN间路由配置"></a>3.三层交换机VLAN间路由配置</h2><p><font size="4">直接使用集成了三层数据包转发功能的交换机进行数据转发。</font></p>
<h3 id="1-建立拓扑-2"><a href="#1-建立拓扑-2" class="headerlink" title="1).建立拓扑"></a>1).建立拓扑</h3><p><a href="https://img-blog.csdnimg.cn/20200229220108476.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200229220108476.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a></p>
<h3 id="2-配置PC1，PC2的ip地址"><a href="#2-配置PC1，PC2的ip地址" class="headerlink" title="2).配置PC1，PC2的ip地址"></a>2).配置PC1，PC2的ip地址</h3><p>PC1<br><a href="https://img-blog.csdnimg.cn/20200229233901832.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200229233901832.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a><br>PC2<br><a href="https://img-blog.csdnimg.cn/20200229233916578.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200229233916578.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a></p>
<h3 id="3-配置交换机-2"><a href="#3-配置交换机-2" class="headerlink" title="3).配置交换机"></a>3).配置交换机</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[AR1]vlan batch 10 20</span><br><span class="line">[AR1]interface vlan 10</span><br><span class="line">[AR1-Vlanif10]ip address 192.168.10.254 24</span><br><span class="line">[AR1-Vlanif10]quit</span><br><span class="line">[AR1]interface vlan 20</span><br><span class="line">[AR1-Vlanif20]ip address 192.168.20.254 24</span><br><span class="line">[AR1-Vlanif20]quit</span><br><span class="line">[AR1]interface e0/0/1</span><br><span class="line">[AR1-Ethernet0/0/1]port link-type access </span><br><span class="line">[AR1-Ethernet0/0/1]port default vlan 10</span><br><span class="line">[AR1]int e0/0/2</span><br><span class="line">[AR1-Ethernet0/0/2]port link-type access </span><br><span class="line">[AR1-Ethernet0/0/2]port default vlan 20</span><br></pre></td></tr></table></figure></div>
<h3 id="4-测试"><a href="#4-测试" class="headerlink" title="4).测试"></a>4).测试</h3><p><a href="https://img-blog.csdnimg.cn/20200229221944190.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200229221944190.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a><br><a href="https://img-blog.csdnimg.cn/2020022922200841.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/2020022922200841.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a></p>
<h1 id="成功！！！"><a href="#成功！！！" class="headerlink" title="成功！！！"></a>成功！！！</h1>]]></content>
  </entry>
  <entry>
    <title>Linux—搭建FTP服务器</title>
    <url>/2020/02/25/Linux%E2%80%94%E6%90%AD%E5%BB%BAFTP%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="搭建FTP服务器"><a href="#搭建FTP服务器" class="headerlink" title="搭建FTP服务器"></a><center>搭建FTP服务器</center></h1><h2 id="1-安装vsftpd服务"><a href="#1-安装vsftpd服务" class="headerlink" title="1.安装vsftpd服务"></a>1.安装vsftpd服务</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum <span class="literal">-y</span> install vsftpd							//安装服务</span><br><span class="line">yum <span class="literal">-y</span> install ftp							//安装软件包</span><br><span class="line">yum <span class="literal">-y</span> install pam							//安装PAM认证</span><br><span class="line">systemctl restart vsftpd						//重新启动服务		</span><br><span class="line">systemctl enable vsftpd							//加入开机自启动</span><br><span class="line">firewall<span class="literal">-cmd</span> -<span class="literal">-permanent</span> -<span class="literal">-add</span><span class="literal">-service</span>=ftp				//防火墙允许ftp请求</span><br><span class="line">firewall<span class="literal">-cmd</span> reload							//立即生效</span><br><span class="line">setsebool <span class="literal">-P</span> ftpd_full_access=on					//selinux允许ftp服务访问</span><br></pre></td></tr></table></figure></div>
<h2 id="2-解析配置文件"><a href="#2-解析配置文件" class="headerlink" title="2.解析配置文件"></a>2.解析配置文件</h2><h3 id="1-主配置文件"><a href="#1-主配置文件" class="headerlink" title="1).主配置文件"></a>1).主配置文件</h3><p><font size="3">(1).通过grep命令过滤一下vsftpd.conf文件</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">cp /etc/vsftpd/vsftpd.conf /etc/vstpd/vsftpd.conf_bak			//先备份</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">grep <span class="literal">-v</span> <span class="string">"#"</span> /etc/vsftpd/vsftpd.conf_bak &gt; /etc/vsftpd/vsftpd.conf   		 //过滤注释</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">vi /etc/vsftpd/vsftpd.conf</span><br><span class="line"></span><br><span class="line">anonymous_enable=YES							//允许匿名				</span><br><span class="line">local_enable=YES							//允许本地用户登录</span><br><span class="line">write_enable=YES							//设置可写权限</span><br><span class="line">local_umask=<span class="number">022</span>								//本地用户上传文件umask值</span><br><span class="line">dirmessage_enable=YES							//是否显示目录说明文件</span><br><span class="line">xferlog_enable=YES							//记录使用者所有上传下载信息 	</span><br><span class="line">connect_from_port_20=YES																									</span><br><span class="line">xferlog_std_format=YES											</span><br><span class="line">listen=NO								//是否以独立运行的方式监听服务</span><br><span class="line">listen_ipv6=YES								//使用ipv6接口监听</span><br><span class="line">pam_service_name=vsftpd							//设置vsfp使用的PAM模块为vsftpd</span><br><span class="line">userlist_enable=YES							//开启用户作用名单文件功能</span><br><span class="line">tcp_wrappers=YES</span><br></pre></td></tr></table></figure></div>
<h3 id="2-PAM配置文件"><a href="#2-PAM配置文件" class="headerlink" title="2).PAM配置文件"></a>2).PAM配置文件</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">10</span>:<span class="number">11</span>:<span class="number">01</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> vi /etc/pam.d/vsftpd</span><br></pre></td></tr></table></figure></div>
<h3 id="3-用户访问控制配置文件"><a href="#3-用户访问控制配置文件" class="headerlink" title="3).用户访问控制配置文件"></a>3).用户访问控制配置文件</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">10</span>:<span class="number">13</span>:<span class="number">23</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> vi /etc/vsftpd/ftpusers			//此名单内的用户不能访问vsftpd服务</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">10</span>:<span class="number">13</span>:<span class="number">23</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> vi /etc/vsftpd/user_list			//取决于userlist_deny参数；</span><br><span class="line">									//NO时允许列表内用户访问FTP服务器；反之不允许</span><br></pre></td></tr></table></figure></div>
<h3 id="4-FTP根目录"><a href="#4-FTP根目录" class="headerlink" title="4).FTP根目录"></a>4).FTP根目录</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">10</span>:<span class="number">18</span>:<span class="number">44</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> ls /var/ftp</span><br><span class="line">pub</span><br></pre></td></tr></table></figure></div>
<h2 id="3-配置匿名用户-最不安全"><a href="#3-配置匿名用户-最不安全" class="headerlink" title="3.配置匿名用户(最不安全)"></a>3.配置匿名用户<font size="4">(最不安全)</font></h2><h3 id="1-匿名用户相关参数"><a href="#1-匿名用户相关参数" class="headerlink" title="1).匿名用户相关参数"></a>1).匿名用户相关参数</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">anonymous_enable=YES							//允许匿名访问模式</span><br><span class="line">anon_umask=<span class="number">022</span>								//匿名用户上传文件的umask值</span><br><span class="line">anon_upload_enable=YES							//允许匿名用户上传文件</span><br><span class="line">anon_mkdir_write_enable=YES						//允许匿名用户创建目录</span><br><span class="line">anon_other_write_enable=YES						//允许匿名用户修改目录名称或删除目录</span><br><span class="line">anon_root=/var/ftp							//设置匿名用户根目录</span><br></pre></td></tr></table></figure></div>
<h3 id="2-配置实例"><a href="#2-配置实例" class="headerlink" title="2).配置实例"></a>2).配置实例</h3><p><font size="4"><strong>搭建一台FTP服务器，允许匿名用户上传和下载文件，匿名用户根目录设置为/var/ftp。</strong></font><br><font size="3">(1).编辑配置文件</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">10</span>:<span class="number">40</span>:<span class="number">19</span> <span class="type">root</span>@<span class="type">localhost</span>/<span class="type">etc</span>/<span class="type">vsftpd</span>]<span class="variable">$</span> vi vsftpd.conf			//添加如下语句</span><br><span class="line"></span><br><span class="line">anonymous_enable=YES</span><br><span class="line">anon_root=/var/ftp</span><br><span class="line">anon_upload_enable=YES</span><br><span class="line">anon_mkdir_write_enable=YES</span><br></pre></td></tr></table></figure></div>
<p>(2).修改pub目录权限,否则其他用户无法新建文件夹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">10</span>:<span class="number">49</span>:<span class="number">23</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> chown ftp /var/ftp/pub			//修改属主</span><br><span class="line"><span class="comment">#[10:49:35 root@localhost~]$ chmod o+w  /var/ftp/pub			//或者增加写权限</span></span><br><span class="line">[<span class="number">10</span>:<span class="number">52</span>:<span class="number">33</span> <span class="type">root</span>@<span class="type">localhost</span>~] systemctl restart vsftpd			//重新启动</span><br></pre></td></tr></table></figure></div>
<h3 id="3-测试"><a href="#3-测试" class="headerlink" title="3).测试"></a>3).测试</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">11</span>:<span class="number">55</span>:<span class="number">41</span> <span class="type">wl</span>@<span class="type">localhost</span>~]<span class="variable">$ftp</span> <span class="number">192.168</span>.<span class="number">3.3</span></span><br><span class="line">Connected to <span class="number">192.168</span>.<span class="number">3.3</span> (<span class="number">192.168</span>.<span class="number">3.3</span>).</span><br><span class="line"><span class="number">220</span> (vsFTPd <span class="number">3.0</span>.<span class="number">2</span>)</span><br><span class="line">Name (<span class="number">192.168</span>.<span class="number">3.3</span>:wl): ftp						//默认为ftp</span><br><span class="line"><span class="number">331</span> Please specify the password.</span><br><span class="line">Password:								//默认为空</span><br><span class="line"><span class="number">230</span> Login successful.</span><br><span class="line">Remote system type is UNIX.</span><br><span class="line"><span class="keyword">Using</span> binary mode to transfer files.</span><br><span class="line">ftp&gt; cd pub						</span><br><span class="line"><span class="number">250</span> Directory successfully changed.</span><br><span class="line">ftp&gt; ls</span><br><span class="line"><span class="number">227</span> Entering Passive Mode (<span class="number">192</span>,<span class="number">168</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">198</span>,<span class="number">147</span>).</span><br><span class="line"><span class="number">150</span> Here comes the directory listing.</span><br><span class="line"><span class="number">226</span> Directory send OK.</span><br><span class="line">ftp&gt; mkdir test								//创建文件</span><br><span class="line"><span class="number">257</span> <span class="string">"/pub/test"</span> created</span><br><span class="line">ftp&gt; ls</span><br><span class="line"><span class="number">227</span> Entering Passive Mode (<span class="number">192</span>,<span class="number">168</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">55</span>,<span class="number">29</span>).</span><br><span class="line"><span class="number">150</span> Here comes the directory listing.</span><br><span class="line">drwx------    <span class="number">2</span> <span class="number">14</span>       <span class="number">50</span>              <span class="number">6</span> Feb <span class="number">25</span> <span class="number">03</span>:<span class="number">55</span> test		//成功</span><br><span class="line"><span class="number">226</span> Directory send OK.</span><br><span class="line">ftp&gt; <span class="keyword">exit</span>								//退出</span><br><span class="line"><span class="number">221</span> Goodbye.</span><br></pre></td></tr></table></figure></div>
<h2 id="4-配置本地模式-相对安全"><a href="#4-配置本地模式-相对安全" class="headerlink" title="4.配置本地模式(相对安全)"></a>4.配置本地模式<font size="4">(相对安全)</font></h2><h3 id="1-本地模式相关参数"><a href="#1-本地模式相关参数" class="headerlink" title="1).本地模式相关参数"></a>1).本地模式相关参数</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">anonymous_enable=NO    						//禁止匿名访问模式</span><br><span class="line">local_enable=YES    						//允许本地用户模式</span><br><span class="line">write_enable=YES    						//设置可写权限</span><br><span class="line">local_umask=<span class="number">022</span>    						//本地用户模式创建文件的umask值</span><br><span class="line">userlist_deny=YES   	 					//启用“禁止用户名单”，名单文件为ftpusers和user_list</span><br><span class="line">userlist_enable=YES    						//开启用户作用名单文件功能</span><br></pre></td></tr></table></figure></div>
<h3 id="2-实例配置"><a href="#2-实例配置" class="headerlink" title="2).实例配置"></a>2).实例配置</h3><p><font size="4"><strong>建立两个用户，不允许他们进入本地系统，将他们的根目录限制在/web/www/html下。</strong></font><br>(1).添加用户</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">12</span>:<span class="number">29</span>:<span class="number">18</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> useradd <span class="literal">-s</span> /sbin/nologin user1	//shell使用/sbin/nologin,此时无法登陆系统</span><br><span class="line">[<span class="number">12</span>:<span class="number">29</span>:<span class="number">42</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> useradd <span class="literal">-s</span> /sbin/nologin user2</span><br><span class="line">[<span class="number">12</span>:<span class="number">29</span>:<span class="number">54</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> passwd user1</span><br><span class="line">[<span class="number">12</span>:<span class="number">29</span>:<span class="number">58</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> passwd user2</span><br></pre></td></tr></table></figure></div>
<p>(2).修改配置文件</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">12</span>:<span class="number">36</span>:<span class="number">28</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> vi /etc/vsftpd/vsftpd.conf</span><br><span class="line">anonymous_enable=NO	</span><br><span class="line">local_enable=YES</span><br><span class="line">local_root=/web/www/html</span><br><span class="line">chroot_local_user=NO</span><br><span class="line">chroot_list_enable=YES</span><br><span class="line">chroot_list_file=/etc/vsftpd/chroot_list</span><br><span class="line">allow_writeable_chroot=YES</span><br><span class="line">write_enable=YES</span><br><span class="line">local_umask=<span class="number">022</span></span><br><span class="line">pam_service_name=vsftpd</span><br></pre></td></tr></table></figure></div>
<p>(3).建立/etc/vsftpd/chroot_list文件, 添加用户账号</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">12</span>:<span class="number">46</span>:<span class="number">02</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> vi /etc/vsftpd/chroot_list</span><br><span class="line">user1</span><br><span class="line">user2</span><br></pre></td></tr></table></figure></div>
<p>(4).修改本地权限</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">12</span>:<span class="number">50</span>:<span class="number">14</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> mkdir /web/www/html <span class="literal">-p</span>			//添加根目录</span><br><span class="line">[<span class="number">12</span>:<span class="number">56</span>:<span class="number">18</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> touch /web/www/html/test.txt</span><br><span class="line">[<span class="number">12</span>:<span class="number">56</span>:<span class="number">32</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> chmod <span class="literal">-R</span> o+w /web/www/html			//增加该目录下的写权限</span><br><span class="line">[<span class="number">12</span>:<span class="number">56</span>:<span class="number">47</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> ll <span class="literal">-d</span> /web/www/html/</span><br><span class="line">drwxr<span class="literal">-xrwx</span> <span class="number">2</span> root root <span class="number">22</span> <span class="number">2</span>月  <span class="number">25</span> <span class="number">12</span>:<span class="number">56</span> /web/www/html/</span><br><span class="line">[<span class="number">12</span>:<span class="number">56</span>:<span class="number">55</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> systemctl restart vsftpd			//重新启动</span><br></pre></td></tr></table></figure></div>
<h3 id="3-测试-1"><a href="#3-测试-1" class="headerlink" title="3).测试"></a>3).测试</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">13</span>:<span class="number">09</span>:<span class="number">01</span> <span class="type">wl</span>@<span class="type">localhost</span>~]<span class="variable">$ftp</span> <span class="number">192.168</span>.<span class="number">3.3</span></span><br><span class="line">Connected to <span class="number">192.168</span>.<span class="number">3.3</span> (<span class="number">192.168</span>.<span class="number">3.3</span>).</span><br><span class="line"><span class="number">220</span> (vsFTPd <span class="number">3.0</span>.<span class="number">2</span>)</span><br><span class="line">Name (<span class="number">192.168</span>.<span class="number">3.3</span>:wl): user2						//使用user2登录</span><br><span class="line"><span class="number">331</span> Please specify the password.</span><br><span class="line">Password:</span><br><span class="line"><span class="number">230</span> Login successful.</span><br><span class="line">Remote system type is UNIX.</span><br><span class="line"><span class="keyword">Using</span> binary mode to transfer files.</span><br><span class="line">ftp&gt; pwd</span><br><span class="line"><span class="number">257</span> <span class="string">"/"</span>							             //目录显示在<span class="string">"/"</span>,其实是在/web//www/html/下</span><br><span class="line">ftp&gt; ls</span><br><span class="line"><span class="number">227</span> Entering Passive Mode (<span class="number">192</span>,<span class="number">168</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">37</span>,<span class="number">191</span>).</span><br><span class="line"><span class="number">150</span> Here comes the directory listing.</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-rw</span>-    <span class="number">1</span> <span class="number">0</span>        <span class="number">0</span>               <span class="number">0</span> Feb <span class="number">25</span> <span class="number">05</span>:<span class="number">14</span> test.txt								</span><br><span class="line">ftp&gt; get test.txt 							//下载文件，权限生效</span><br><span class="line">local: test.txt remote: test.txt</span><br><span class="line"><span class="number">227</span> Entering Passive Mode (<span class="number">192</span>,<span class="number">168</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">53</span>,<span class="number">3</span>).</span><br><span class="line"><span class="number">150</span> Opening BINARY mode <span class="keyword">data</span> connection <span class="keyword">for</span> test.txt (<span class="number">0</span> bytes).</span><br><span class="line"><span class="number">226</span> Transfer complete.</span><br><span class="line">ftp&gt; put <span class="number">1</span>.txt								//上传文件</span><br><span class="line">local: <span class="number">1</span>.txt remote: <span class="number">1</span>.txt</span><br><span class="line"><span class="number">227</span> Entering Passive Mode (<span class="number">192</span>,<span class="number">168</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">73</span>,<span class="number">3</span>).</span><br><span class="line"><span class="number">150</span> Ok to send data.</span><br><span class="line"><span class="number">226</span> Transfer complete.</span><br><span class="line">ftp&gt; ls	</span><br><span class="line"><span class="number">227</span> Entering Passive Mode (<span class="number">192</span>,<span class="number">168</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">119</span>,<span class="number">79</span>).</span><br><span class="line"><span class="number">150</span> Here comes the directory listing.</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--    <span class="number">1</span> <span class="number">1004</span>     <span class="number">1004</span>            <span class="number">0</span> Feb <span class="number">25</span> <span class="number">05</span>:<span class="number">15</span> <span class="number">1</span>.txt			//上传成功</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-rw</span>-    <span class="number">1</span> <span class="number">0</span>        <span class="number">0</span>               <span class="number">0</span> Feb <span class="number">25</span> <span class="number">05</span>:<span class="number">14</span> test.txt</span><br><span class="line"><span class="number">226</span> Directory send OK.</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">13</span>:<span class="number">16</span>:<span class="number">20</span> <span class="type">wl</span>@<span class="type">localhost</span>~]<span class="variable">$ftp</span> <span class="number">192.168</span>.<span class="number">3.3</span></span><br><span class="line">Connected to <span class="number">192.168</span>.<span class="number">3.3</span> (<span class="number">192.168</span>.<span class="number">3.3</span>).</span><br><span class="line"><span class="number">220</span> (vsFTPd <span class="number">3.0</span>.<span class="number">2</span>)</span><br><span class="line">Name (<span class="number">192.168</span>.<span class="number">3.3</span>:wl): wl						//未禁锢的用户</span><br><span class="line"><span class="number">331</span> Please specify the password.</span><br><span class="line">Password:</span><br><span class="line"><span class="number">230</span> Login successful.</span><br><span class="line">Remote system type is UNIX.</span><br><span class="line"><span class="keyword">Using</span> binary mode to transfer files.</span><br><span class="line">ftp&gt; pwd</span><br><span class="line"><span class="number">257</span> <span class="string">"/web/www/html"</span>										</span><br><span class="line">ftp&gt; cd /etc/vsftpd/							//可以进入本地系统目录,很危险！</span><br><span class="line"><span class="number">250</span> Directory successfully changed.</span><br><span class="line">ftp&gt; ls	</span><br><span class="line"><span class="number">227</span> Entering Passive Mode (<span class="number">192</span>,<span class="number">168</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">21</span>,<span class="number">149</span>).</span><br><span class="line"><span class="number">150</span> Here comes the directory listing.</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--    <span class="number">1</span> <span class="number">0</span>        <span class="number">0</span>              <span class="number">12</span> Feb <span class="number">25</span> <span class="number">04</span>:<span class="number">46</span> chroot_list</span><br><span class="line"><span class="literal">-rw</span>-------    <span class="number">1</span> <span class="number">0</span>        <span class="number">0</span>             <span class="number">125</span> Oct <span class="number">30</span>  <span class="number">2018</span> ftpusers</span><br><span class="line"><span class="literal">-rw</span>-------    <span class="number">1</span> <span class="number">0</span>        <span class="number">0</span>             <span class="number">361</span> Oct <span class="number">30</span>  <span class="number">2018</span> user_list</span><br><span class="line"><span class="literal">-rw</span>-------    <span class="number">1</span> <span class="number">0</span>        <span class="number">0</span>             <span class="number">474</span> Feb <span class="number">25</span> <span class="number">04</span>:<span class="number">39</span> vsftpd.conf</span><br><span class="line"><span class="literal">-rw</span>-------    <span class="number">1</span> <span class="number">0</span>        <span class="number">0</span>            <span class="number">5116</span> Feb <span class="number">25</span> <span class="number">02</span>:<span class="number">03</span> vsftpd.conf_bak</span><br><span class="line"><span class="literal">-rwxr</span>-<span class="literal">-r</span>--    <span class="number">1</span> <span class="number">0</span>        <span class="number">0</span>             <span class="number">338</span> Oct <span class="number">30</span>  <span class="number">2018</span> vsftpd_conf_migrate.sh</span><br><span class="line"><span class="number">226</span> Directory send OK.</span><br></pre></td></tr></table></figure></div>
<h2 id="5-配置虚拟用户"><a href="#5-配置虚拟用户" class="headerlink" title="5.配置虚拟用户"></a>5.配置虚拟用户</h2><h3 id="1-虚拟用户相关参数"><a href="#1-虚拟用户相关参数" class="headerlink" title="1).虚拟用户相关参数"></a>1).虚拟用户相关参数</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">guest_enable=YES						//开启虚拟账号访问</span><br><span class="line">guest_username=vuser						//设置虚拟账号对应的系统账号为vuser</span><br><span class="line">listen=YES							//设置FTP服务器为独立运行</span><br><span class="line">max_clients=<span class="number">300</span>							//ftp接入最大客户端数量为<span class="number">300</span></span><br><span class="line">max_per_ip=<span class="number">10</span>							//每个ip最大连接数	</span><br><span class="line">anon_world_readable_only=yes					//虚拟账号全局可读</span><br><span class="line">anon_max_rate=<span class="number">30000</span>						//传输速率为<span class="number">30</span>KB/s</span><br></pre></td></tr></table></figure></div>
<h3 id="2-实例配置-1"><a href="#2-实例配置-1" class="headerlink" title="2).实例配置"></a>2).实例配置</h3><p><font size="4"><strong>使用虚拟用户test1，test2登录ftp服务器，访问主目录是/var/ftp/vuser，用户只能查看文件，不能上传修改，并设置连接数，速率。</strong></font><br>(1).创建，生成用户数据库</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">14</span>:<span class="number">19</span>:<span class="number">48</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> mkdir /vsftp</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">14</span>:<span class="number">23</span>:<span class="number">07</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> vi /vsftp/vuser.txt			//创建文件</span><br><span class="line">test1								//用户名</span><br><span class="line"><span class="number">12345678</span>							//用户密码</span><br><span class="line">test2</span><br><span class="line"><span class="number">12345678</span></span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">14</span>:<span class="number">25</span>:<span class="number">07</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> db_load <span class="literal">-T</span> <span class="literal">-t</span> hash <span class="operator">-f</span> /vsftp/vuser.txt /vsftp/vuser.db	 //生成数据库</span><br><span class="line">[<span class="number">14</span>:<span class="number">33</span>:<span class="number">37</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> chmod <span class="number">700</span> /vsftp/vuser.db			  	 	//修改权限</span><br></pre></td></tr></table></figure></div>
<p>(2).配置PAM文件</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">14</span>:<span class="number">38</span>:<span class="number">25</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#vi /etc/pam.d/vsftpd </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#%PAM-1.0</span></span><br><span class="line"><span class="comment">#session    optional     pam_keyinit.so    force revoke				//注释掉原有的</span></span><br><span class="line"><span class="comment">#auth       required    pam_listfile.so item=user sense=deny file=/etc/vsftpd/ftpusers onerr=succeed</span></span><br><span class="line"><span class="comment">#auth       required    pam_shells.so</span></span><br><span class="line"><span class="comment">#auth       include     password-auth</span></span><br><span class="line"><span class="comment">#account    include     password-auth</span></span><br><span class="line"><span class="comment">#session    required     pam_loginuid.so</span></span><br><span class="line"><span class="comment">#session    include     password-auth</span></span><br><span class="line">auth        required    pam_userdb.so   db=/vsftp/vuser				//使用pam_userdb.so模块，db=数据库路径</span><br><span class="line">account     required    pam_userdb.so   db=/vsftp/vuser</span><br></pre></td></tr></table></figure></div>
<p>(3).创建虚拟账户对应系统用户</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">14</span>:<span class="number">41</span>:<span class="number">58</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> useradd <span class="literal">-d</span> /var/ftp/vuser vuser				</span><br><span class="line">[<span class="number">14</span>:<span class="number">42</span>:<span class="number">39</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> chown vuser.vuser /var/ftp/vuser			//修改属组为vuser</span><br><span class="line">[<span class="number">14</span>:<span class="number">46</span>:<span class="number">17</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> chmod <span class="number">555</span>  /var/ftp/vuser				//vuser下的用户不能写入</span><br><span class="line">[<span class="number">14</span>:<span class="number">47</span>:<span class="number">46</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> ll <span class="literal">-ld</span>  /var/ftp/vuser/</span><br><span class="line">dr<span class="literal">-xr</span><span class="literal">-xr</span><span class="literal">-x</span> <span class="number">3</span> vuser vuser <span class="number">78</span> <span class="number">2</span>月  <span class="number">25</span> <span class="number">14</span>:<span class="number">42</span> /var/ftp/vuser/</span><br></pre></td></tr></table></figure></div>
<p>(4).修改配置文件</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">14</span>:<span class="number">48</span>:<span class="number">37</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> vi /etc/vsftpd/vsftpd.conf</span><br><span class="line"></span><br><span class="line">anonymous_enable=NO</span><br><span class="line">anon_root=/var/ftp</span><br><span class="line">anon_upload_enable=NO				</span><br><span class="line">anon_mkdir_write_enable=NO</span><br><span class="line">local_enable=YES</span><br><span class="line">chroot_local_user=YES							//锁定账户的根目录		</span><br><span class="line">allow_writeable_chroot=YES						</span><br><span class="line">write_enable=NO								//关闭用户写权限				</span><br><span class="line">guest_enable=YES								</span><br><span class="line">guest_username=vuser	</span><br><span class="line">listen=YES</span><br><span class="line">pam_service_name=vsftpd							</span><br><span class="line">max_clients=<span class="number">300</span>								</span><br><span class="line">max_per_ip=<span class="number">10</span>									</span><br><span class="line">anon_world_readable_only=yes				</span><br><span class="line">anon_max_rate=<span class="number">30000</span></span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">14</span>:<span class="number">54</span>:<span class="number">34</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="variable">$</span> systemctl restart vsftpd</span><br></pre></td></tr></table></figure></div>
<h3 id="3-测试-2"><a href="#3-测试-2" class="headerlink" title="3).测试"></a>3).测试</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">15</span>:<span class="number">06</span>:<span class="number">27</span> <span class="type">wl</span>@<span class="type">localhost</span>~]<span class="variable">$ftp</span> <span class="number">192.168</span>.<span class="number">3.3</span></span><br><span class="line">Connected to <span class="number">192.168</span>.<span class="number">3.3</span> (<span class="number">192.168</span>.<span class="number">3.3</span>).</span><br><span class="line"><span class="number">220</span> (vsFTPd <span class="number">3.0</span>.<span class="number">2</span>)</span><br><span class="line">Name (<span class="number">192.168</span>.<span class="number">3.3</span>:wl): test1						//用户登录</span><br><span class="line"><span class="number">331</span> Please specify the password.</span><br><span class="line">Password:</span><br><span class="line"><span class="number">230</span> Login successful.</span><br><span class="line">Remote system type is UNIX.</span><br><span class="line"><span class="keyword">Using</span> binary mode to transfer files.</span><br><span class="line">ftp&gt; cd /home					</span><br><span class="line"><span class="number">550</span> Failed to change directory.					 	//不能更改主目录</span><br><span class="line">ftp&gt; mkdir test</span><br><span class="line"><span class="number">550</span> Permission denied.							//只能查看，无法写入</span><br></pre></td></tr></table></figure></div>
<h1 id="成功！！！"><a href="#成功！！！" class="headerlink" title="成功！！！"></a>成功！！！</h1>]]></content>
  </entry>
  <entry>
    <title>Linux—搭建Web服务器</title>
    <url>/2020/02/23/Linux%E2%80%94%E6%90%AD%E5%BB%BAWeb%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Linux搭建Web服务器"><a href="#Linux搭建Web服务器" class="headerlink" title="Linux搭建Web服务器"></a>Linux搭建Web服务器</h1><h2 id="1-web服务器简介"><a href="#1-web服务器简介" class="headerlink" title="1.web服务器简介"></a><a href="https://baike.baidu.com/item/WEB%E6%9C%8D%E5%8A%A1%E5%99%A8/8390210?fr=aladdin" target="_blank" rel="noopener">1.web服务器简介</a></h2><h2 id="2-配置文件解析"><a href="#2-配置文件解析" class="headerlink" title="2.配置文件解析"></a>2.配置文件解析</h2><h3 id="1-安装httpd服务"><a href="#1-安装httpd服务" class="headerlink" title="1).安装httpd服务"></a>1).安装httpd服务</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum <span class="literal">-y</span> install httpd</span><br></pre></td></tr></table></figure></div>
<h3 id="2-启动httpd服务"><a href="#2-启动httpd服务" class="headerlink" title="2).启动httpd服务"></a>2).启动httpd服务</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">systemctl start httpd</span><br><span class="line">lsof <span class="literal">-i</span>:<span class="number">80</span>		//查看<span class="number">80</span>端口是否开启</span><br></pre></td></tr></table></figure></div>
<h3 id="3-各配置文件目录"><a href="#3-各配置文件目录" class="headerlink" title="3).各配置文件目录"></a>3).各配置文件目录</h3><p><font face="微软雅黑" size="3">服务目录：/etc/httpd/<br>主配置文件：/etc/httpd/conf/httpd.conf<br>网页目录：/var/www/html/<br>服务脚本：/etc/init.d/httpd<br>执行程序：/usr/sbin/httpd</font></p>
<h3 id="4-查看主配置文件"><a href="#4-查看主配置文件" class="headerlink" title="4).查看主配置文件"></a>4).查看主配置文件</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">10</span>:<span class="number">53</span>:<span class="number">44</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> vi /etc/httpd/conf/httpd.conf</span><br><span class="line"></span><br><span class="line">	.....</span><br><span class="line">ServerRoot <span class="string">"/etc/httpd"</span> 	//Apache根目录</span><br><span class="line">	......</span><br><span class="line">Listen <span class="number">80</span>		//服务端口</span><br><span class="line">	......</span><br><span class="line">ServerAdmin root@localhost		//管理员邮箱地址，当网页发生错误时会发邮件给此邮箱</span><br><span class="line">	......</span><br><span class="line">ServerName www.example.com			//设置域名</span><br><span class="line">	......</span><br><span class="line">&lt;Directory /&gt;						//根目录权限设置</span><br><span class="line">    AllowOverride none				//设置禁止使用控制文件，默认为.htacces文件</span><br><span class="line">    Require all denied				//禁止所以的用户访问</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line">	......</span><br><span class="line">DocumentRoot <span class="string">"/var/www/html"</span>			//默认站点目录</span><br><span class="line">&lt;Directory <span class="string">"/var/www"</span>&gt;</span><br><span class="line">    AllowOverride None</span><br><span class="line">    <span class="comment">#Allow open access:			  </span></span><br><span class="line">    Require all granted				//允许所以用户访问</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line">    .......</span><br></pre></td></tr></table></figure></div>
<h2 id="3-Apache服务搭建"><a href="#3-Apache服务搭建" class="headerlink" title="3.Apache服务搭建"></a>3.Apache服务搭建</h2><h3 id="1-实现域名访问"><a href="#1-实现域名访问" class="headerlink" title="1).实现域名访问"></a>1).实现域名访问</h3><p><font size="4">(1).编辑子配置文件</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">10</span>:<span class="number">53</span>:<span class="number">44</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> vi /etc/httpd/conf.d/httpd<span class="literal">-vhosts</span>.conf</span><br><span class="line"></span><br><span class="line">&lt;VirtualHost *:<span class="number">80</span>&gt;			//使用的端口</span><br><span class="line">	ServerName www.test.com		//使用此域名	</span><br><span class="line">	DocumentRoot <span class="string">"/var/www/html"</span></span><br><span class="line">	&lt;Directory <span class="string">"/var/www/html"</span>&gt;	</span><br><span class="line">		&lt;Requireall&gt;</span><br><span class="line">			Require all granted			//允许所有用户访问</span><br><span class="line">            <span class="comment">#Require not ip 192.168.3.2		//此ip不能访问(黑名单)</span></span><br><span class="line">          	<span class="comment">#Require ip 192.168.3.3	//只允许此用户访问(白名单)</span></span><br><span class="line">		&lt;/Requireall&gt;</span><br><span class="line">	&lt;/Directory&gt;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure></div>
<p><font size="4">(2).编辑站点文件</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">10</span>:<span class="number">53</span>:<span class="number">44</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> vi /var/www/html/index.html		</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;this is test server&lt;h1&gt;</span><br></pre></td></tr></table></figure></div>
<p><font size="4">(3).域名ip绑定为本地主机ip,并设置DNS</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">10</span>:<span class="number">53</span>:<span class="number">44</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> vi /var/named/test.com.zone </span><br><span class="line"></span><br><span class="line"><span class="variable">$TTL</span> <span class="number">1</span>D</span><br><span class="line"><span class="selector-tag">@</span>       <span class="keyword">IN</span> SOA  www.test.com.   admin.test.com.(</span><br><span class="line">                                        <span class="number">0</span>       ; serial</span><br><span class="line">                                        <span class="number">1</span>D      ; refresh</span><br><span class="line">                                        <span class="number">1</span>H      ; retry</span><br><span class="line">                                        <span class="number">1</span>W      ; expire</span><br><span class="line">                                        <span class="number">3</span>H )    ; minimum</span><br><span class="line">        <span class="keyword">IN</span>      NS      www.test.com.</span><br><span class="line">www     <span class="keyword">IN</span>      A       <span class="number">192.168</span>.<span class="number">3.3</span></span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">10</span>:<span class="number">59</span>:<span class="number">53</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> vi /etc/resolv.conf </span><br><span class="line"></span><br><span class="line">; generated by /usr/sbin/dhclient<span class="literal">-script</span></span><br><span class="line">nameserver <span class="number">192.168</span>.<span class="number">3.3</span></span><br><span class="line">nameserver <span class="number">183.60</span>.<span class="number">83.19</span></span><br></pre></td></tr></table></figure></div>
<p><font size="5"><strong>测试</strong></font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">11</span>:<span class="number">27</span>:<span class="number">25</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> systemctl restart httpd.service		//重启服务</span><br><span class="line">[<span class="number">11</span>:<span class="number">28</span>:<span class="number">01</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> systemctl restart named.service</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">11</span>:<span class="number">01</span>:<span class="number">37</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> curl www.test.com</span><br><span class="line">&lt;h1&gt;<span class="number">66666</span>&lt;h1&gt;</span><br></pre></td></tr></table></figure></div>
<h3 id="2-实现用户认证访问"><a href="#2-实现用户认证访问" class="headerlink" title="2).实现用户认证访问"></a>2).实现用户认证访问</h3><p><font size="4">(1).创建用户及用户组站点目录</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">11</span>:<span class="number">10</span>:<span class="number">11</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> useradd admin1</span><br><span class="line">[<span class="number">11</span>:<span class="number">16</span>:<span class="number">25</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> useradd admin2</span><br><span class="line">[<span class="number">11</span>:<span class="number">16</span>:<span class="number">29</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> mkdir /var/www/html/admin</span><br><span class="line">[<span class="number">11</span>:<span class="number">16</span>:<span class="number">37</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> vi /var/www/html/admin/index.html</span><br><span class="line"></span><br><span class="line">welcome!</span><br></pre></td></tr></table></figure></div>
<p><font size="4">(2).配置文件</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">&lt;VirtualHost *:<span class="number">80</span>&gt;</span><br><span class="line">        ServerName www.wl.com</span><br><span class="line">        DocumentRoot <span class="string">"/var/www/html/admin"</span>		//用户组站点目录</span><br><span class="line">        &lt;Directory <span class="string">"/var/www/html/admin"</span>&gt;</span><br><span class="line">                        AllowOverride none</span><br><span class="line">                        AuthType Basic			//基于Basic认证</span><br><span class="line">                        AuthName <span class="string">"please login"</span>		//认证时显示的信息</span><br><span class="line">                        AuthUserfile <span class="string">"/etc/httpd/conf/.htpasswd"</span>	//认证是用户账号密码文件</span><br><span class="line">                        AuthGroupfile <span class="string">"/etc/httpd/conf/.htgroup"</span>	//基于组的认证</span><br><span class="line">                        Require group admin 		//admin组内的都可以访问</span><br><span class="line">        &lt;/Directory&gt;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure></div>
<p><font size="4">(3).配置用户及密码</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">11</span>:<span class="number">29</span>:<span class="number">56</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> htpasswd <span class="literal">-b</span> <span class="literal">-c</span> <span class="literal">-m</span> /etc/httpd/conf/.htpasswd admin1 Centos //为用户admin1创建以Centos为密码的文件，<span class="literal">-c</span>表示覆盖原来的文件内容</span><br><span class="line">[<span class="number">11</span>:<span class="number">30</span>:<span class="number">11</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> htpasswd <span class="literal">-b</span> <span class="literal">-m</span> /etc/httpd/conf/.htpasswd admin2 Centos</span><br></pre></td></tr></table></figure></div>
<p><font size="4">(4).编辑组文件和密码文件</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">11</span>:<span class="number">38</span>:<span class="number">52</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> vi /etc/httpd/conf/.htgroup		//创建一个组文件</span><br><span class="line"></span><br><span class="line">admin:amdin1 admin2</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">11</span>:<span class="number">42</span>:<span class="number">59</span> <span class="type">root</span>@<span class="type">yc</span> /<span class="type">etc</span>/<span class="type">httpd</span>/<span class="type">conf</span>]<span class="variable">$</span> chmod <span class="number">744</span> .htgroup 		//改变文件权限，让其他人可读</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">11</span>:<span class="number">39</span>:<span class="number">59</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> vi /etc/httpd/conf/.htpasswd 		//组密码文件</span><br><span class="line"></span><br><span class="line">admin1:<span class="variable">$apr1</span><span class="variable">$Qj5kCGKd</span><span class="variable">$qPfDi5HDufciCQGCSd29I</span>/</span><br><span class="line">admin2:<span class="variable">$apr1</span><span class="variable">$i</span>/VneyuX<span class="variable">$Nb3m3bLU09F</span>..niq7cH6j/</span><br></pre></td></tr></table></figure></div>
<p><font size="5"><strong>测试</strong></font><br><font size="4">(1).在客户端C:\Windows\System32\drivers\etc\hosts文件中添加ip及域名<br><a href="https://img-blog.csdnimg.cn/20200223120521570.png" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200223120521570.png" class="lazyload" title="在这里插入图片描述"></a><br><font size="4">(2).浏览器进行访问<br><a href="https://img-blog.csdnimg.cn/2020022312064999.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/2020022312064999.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a></font></font></p>
<h3 id="3-实现不同端口访问"><a href="#3-实现不同端口访问" class="headerlink" title="3).实现不同端口访问"></a>3).实现不同端口访问</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">12</span>:<span class="number">13</span>:<span class="number">27</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#vi /etc/httpd/conf.d/httpd-vhosts.conf</span></span><br><span class="line"></span><br><span class="line">Listen <span class="number">8082</span>				//添加监听端口</span><br><span class="line">Listen <span class="number">9092</span></span><br><span class="line">&lt;VirtualHost *:<span class="number">8082</span>&gt;			</span><br><span class="line">        Servername www.test.com</span><br><span class="line">        DocumentRoot <span class="string">"/app/admin/admin1"</span></span><br><span class="line">        &lt;Directory <span class="string">"/app/admin/admin1"</span>&gt;</span><br><span class="line">        AllowOverride none</span><br><span class="line">        Require all granted</span><br><span class="line">        &lt;/Directory&gt;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line">&lt;VirtualHost *:<span class="number">9092</span>&gt;</span><br><span class="line">        Servername www.test.com</span><br><span class="line">        DocumentRoot <span class="string">"/app/admin/admin2"</span></span><br><span class="line">        &lt;Directory <span class="string">"/app/admin/admin2"</span>&gt;</span><br><span class="line">        AllowOverride none</span><br><span class="line">        Require all granted</span><br><span class="line">        &lt;/Directory&gt;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure></div>
<p><font size="5"><strong>测试</strong></font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">12</span>:<span class="number">29</span>:<span class="number">29</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#systemctl restart httpd.service		//重启服务</span></span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">12</span>:<span class="number">30</span>:<span class="number">06</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#curl www.test.com:8082</span></span><br><span class="line">this is admin1</span><br><span class="line">[<span class="number">12</span>:<span class="number">30</span>:<span class="number">09</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#curl www.test.com:9092</span></span><br><span class="line">this is admin2</span><br></pre></td></tr></table></figure></div>
<h3 id="3-实现不同IP访问"><a href="#3-实现不同IP访问" class="headerlink" title="3).实现不同IP访问"></a>3).实现不同IP访问</h3><p><font size="4">(1).网卡添加ip地址</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">14</span>:<span class="number">26</span>:<span class="number">00</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#ifconfig ens33:1 192.168.3.4/24</span></span><br></pre></td></tr></table></figure></div>
<p><font size="4">(2).配置文件</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">14</span>:<span class="number">35</span>:<span class="number">05</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#vi /etc/httpd/conf.d/httpd-vhosts.conf </span></span><br><span class="line"></span><br><span class="line">&lt;VirtualHost <span class="number">192.168</span>.<span class="number">3.3</span>:<span class="number">80</span>&gt;</span><br><span class="line">        DocumentRoot <span class="string">"/app/admin/admin1"</span></span><br><span class="line">        &lt;Directory <span class="string">"/app/admin/admin1"</span>&gt;</span><br><span class="line">        Require all granted</span><br><span class="line">        &lt;/Directory&gt;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line">&lt;VirtualHost <span class="number">192.168</span>.<span class="number">3.4</span>:<span class="number">80</span>&gt;</span><br><span class="line">        DocumentRoot <span class="string">"/app/admin/admin2"</span></span><br><span class="line">        &lt;Directory <span class="string">"/app/admin/admin2"</span>&gt;</span><br><span class="line">        Require all granted</span><br><span class="line">        &lt;/Directory&gt;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure></div>
<p><font size="5"><strong>测试</strong></font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">14</span>:<span class="number">34</span>:<span class="number">23</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#systemctl restart httpd.service</span></span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">14</span>:<span class="number">37</span>:<span class="number">20</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#curl 192.168.3.3</span></span><br><span class="line">this is admin1</span><br><span class="line">[<span class="number">14</span>:<span class="number">39</span>:<span class="number">35</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#curl 192.168.3.4</span></span><br><span class="line">this is admin2</span><br></pre></td></tr></table></figure></div>
<h3 id="4-实现不同域名访问"><a href="#4-实现不同域名访问" class="headerlink" title="4).实现不同域名访问"></a>4).实现不同域名访问</h3><p><font size="4">(1).配置文件</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">14</span>:<span class="number">39</span>:<span class="number">37</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#vi /etc/httpd/conf.d/httpd-vhosts.conf </span></span><br><span class="line"></span><br><span class="line">&lt;VirtualHost *:<span class="number">80</span>&gt;</span><br><span class="line">        Servername www.test.com</span><br><span class="line">        DocumentRoot <span class="string">"/app/admin/admin1"</span></span><br><span class="line">        &lt;Directory <span class="string">"/app/admin/admin1"</span>&gt;</span><br><span class="line">        Require all granted</span><br><span class="line">        &lt;/Directory&gt;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line">&lt;VirtualHost *:<span class="number">80</span>&gt;</span><br><span class="line">        Servername www1.test.com</span><br><span class="line">        DocumentRoot <span class="string">"/app/admin/admin2"</span></span><br><span class="line">        &lt;Directory <span class="string">"/app/admin/admin2"</span>&gt;</span><br><span class="line">        Require all granted</span><br><span class="line">        &lt;/Directory&gt;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure></div>
<p><font size="4">(2).添加域名</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">15</span>:<span class="number">08</span>:<span class="number">30</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#vi /var/named/test.zone 			//正向文件</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$TTL</span> <span class="number">1</span>D</span><br><span class="line"><span class="selector-tag">@</span>       <span class="keyword">IN</span> SOA  www.test.com    root.test.com. (</span><br><span class="line">                                        <span class="number">0</span>       ; serial</span><br><span class="line">                                        <span class="number">1</span>D      ; refresh</span><br><span class="line">                                        <span class="number">1</span>H      ; retry</span><br><span class="line">                                        <span class="number">1</span>W      ; expire</span><br><span class="line">                                        <span class="number">3</span>H )    ; minimum</span><br><span class="line">        <span class="keyword">IN</span>      NS      www.test.com.</span><br><span class="line">www     <span class="keyword">IN</span>      A       <span class="number">192.168</span>.<span class="number">3.3</span></span><br><span class="line">www1    <span class="keyword">IN</span>      A       <span class="number">192.168</span>.<span class="number">3.3</span></span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">15</span>:<span class="number">11</span>:<span class="number">01</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#vi /var/named/192.168.19.local 	//反向文件</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$TTL</span> <span class="number">1</span>D</span><br><span class="line"><span class="selector-tag">@</span>       <span class="keyword">IN</span> SOA  www.test.com    root.test.com.(</span><br><span class="line">                                        <span class="number">0</span>       ; serial</span><br><span class="line">                                        <span class="number">1</span>D      ; refresh</span><br><span class="line">                                        <span class="number">1</span>H      ; retry</span><br><span class="line">                                        <span class="number">1</span>W      ; expire</span><br><span class="line">                                        <span class="number">3</span>H )    ; minimum</span><br><span class="line">        <span class="keyword">IN</span>      NS      test.com.</span><br><span class="line"><span class="number">3</span>       <span class="keyword">IN</span>      PTR     www.test.com.</span><br><span class="line"><span class="number">3</span>       <span class="keyword">IN</span>      PTR     www1.test.com.</span><br></pre></td></tr></table></figure></div>
<p><font size="5"><strong>测试</strong></font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">15</span>:<span class="number">00</span>:<span class="number">20</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#systemctl restart named.service</span></span><br><span class="line">[<span class="number">15</span>:<span class="number">00</span>:<span class="number">22</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#systemctl restart httpd.service</span></span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">15</span>:<span class="number">08</span>:<span class="number">23</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#curl www.test.com</span></span><br><span class="line">this is admin1</span><br><span class="line">[<span class="number">15</span>:<span class="number">08</span>:<span class="number">28</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#curl www1.test.com</span></span><br><span class="line">this is admin2</span><br></pre></td></tr></table></figure></div>
<h1 id="成功！！！"><a href="#成功！！！" class="headerlink" title="成功！！！"></a>成功！！！</h1>]]></content>
  </entry>
  <entry>
    <title>Redhat配置yum源</title>
    <url>/2020/02/21/Redhat%E9%85%8D%E7%BD%AEyum%E6%BA%90/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Redhat7-X配置yum源"><a href="#Redhat7-X配置yum源" class="headerlink" title="Redhat7.X配置yum源"></a>Redhat7.X配置yum源</h1><p><font face="黑体" size="4">因为Redhat系统不再起官网注册，系统安装完成后无法正常使用yum源，所以将其Redhat yum源修改为CentOS yum源。</font></p>
<h2 id="1-删除redhat自带yum源"><a href="#1-删除redhat自带yum源" class="headerlink" title="1.删除redhat自带yum源"></a>1.删除redhat自带yum源</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">rm <span class="literal">-rf</span> /etc/rpm/./m*</span><br></pre></td></tr></table></figure></div>
<h2 id="2-从阿里云下载yum相关安装包"><a href="#2-从阿里云下载yum相关安装包" class="headerlink" title="2.从阿里云下载yum相关安装包"></a>2.从阿里云下载yum相关安装包</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">wget https://mirrors.aliyun.com/centos/<span class="number">7</span>/os/x86_64/Packages/yum<span class="literal">-metadata</span><span class="literal">-parser</span><span class="literal">-1</span>.<span class="number">1.4</span><span class="literal">-10</span>.el7.x86_64.rpm</span><br><span class="line">wget https://mirrors.aliyun.com/centos/<span class="number">7</span>/os/x86_64/Packages/yum<span class="literal">-utils</span><span class="literal">-1</span>.<span class="number">1.31</span><span class="literal">-52</span>.el7.noarch.rpm</span><br><span class="line">wget https://mirrors.aliyun.com/centos/<span class="number">7</span>/os/x86_64/Packages/yum<span class="literal">-3</span>.<span class="number">4.3</span><span class="literal">-163</span>.el7.centos.noarch.rpm</span><br><span class="line">wget https://mirrors.aliyun.com/centos/<span class="number">7</span>/os/x86_64/Packages/yum<span class="literal">-plugin</span><span class="literal">-fastestmirror</span><span class="literal">-1</span>.<span class="number">1.31</span><span class="literal">-52</span>.el7.noarch.rpm</span><br><span class="line">wget https://mirrors.aliyun.com/centos/<span class="number">7</span>/os/x86_64/Packages/python<span class="literal">-urlgrabber</span><span class="literal">-3</span>.<span class="number">10</span><span class="literal">-9</span>.el7.noarch.rpm</span><br></pre></td></tr></table></figure></div>
<h2 id="3-强制安装rpm包"><a href="#3-强制安装rpm包" class="headerlink" title="3.强制安装rpm包"></a>3.强制安装rpm包</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">rpm <span class="literal">-ivh</span> python<span class="literal">-urlgrabber</span><span class="literal">-3</span>.<span class="number">10</span><span class="literal">-8</span>.el7.noarch.rpm -<span class="literal">-force</span> -<span class="literal">-nodeps</span></span><br><span class="line"></span><br><span class="line">rpm <span class="literal">-ivh</span> yum* -<span class="literal">-force</span> -<span class="literal">-nodeps</span></span><br></pre></td></tr></table></figure></div>
<h2 id="4-下载yum源"><a href="#4-下载yum源" class="headerlink" title="4.下载yum源"></a>4.下载yum源</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">wget <span class="literal">-o</span> /etc/yum.repos.d/CentOS<span class="literal">-Base</span>.repo http://mirrors.aliyun.com/repo/Centos<span class="literal">-7</span>.repo</span><br></pre></td></tr></table></figure></div>
<h2 id="5-修改yum源文件"><a href="#5-修改yum源文件" class="headerlink" title="5.修改yum源文件"></a>5.修改yum源文件</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">vi /etc/yum.repos.d/CentOS<span class="literal">-Base</span>.repo</span><br></pre></td></tr></table></figure></div>
<p><font face="黑体" size="4">在vim中执行“:%s/$releasever/7/g”替换关键字</font></p>
<h2 id="6-清空重载yum缓存"><a href="#6-清空重载yum缓存" class="headerlink" title="6.清空重载yum缓存"></a>6.清空重载yum缓存</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br><span class="line">yum update</span><br></pre></td></tr></table></figure></div>
<h1 id="成功！！！"><a href="#成功！！！" class="headerlink" title="成功！！！"></a>成功！！！</h1>]]></content>
  </entry>
  <entry>
    <title>PXE自动批量安装linux系统</title>
    <url>/2020/02/20/PXE%E8%87%AA%E5%8A%A8%E6%89%B9%E9%87%8F%E5%AE%89%E8%A3%85linux%E7%B3%BB%E7%BB%9F/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="PXE批量安装Linux"><a href="#PXE批量安装Linux" class="headerlink" title="PXE批量安装Linux"></a>PXE批量安装Linux</h1><h2 id="准备："><a href="#准备：" class="headerlink" title="准备："></a>准备：</h2><p><font size="4">主服务器：1.安装CentOS<br>　　　　　２.安装DHCP，给客户端配置ip<br>　　　　　３.安装TFTP传输引导文件<br>　　　　　４.安装http，提供下载<br>　　　　　</font></p>
<h2 id="1-配置服务端网络"><a href="#1-配置服务端网络" class="headerlink" title="1.配置服务端网络"></a>1.配置服务端网络</h2><h3 id="1-网络连接方式改为“仅主机”"><a href="#1-网络连接方式改为“仅主机”" class="headerlink" title="1).网络连接方式改为“仅主机”"></a>1).网络连接方式改为“仅主机”</h3><p><a href="https://img-blog.csdnimg.cn/20200220125403205.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200220125403205.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a></p>
<h3 id="2-配置本地网络"><a href="#2-配置本地网络" class="headerlink" title="2). 配置本地网络"></a>2). 配置本地网络</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">vi /etc/sysconfig/network<span class="literal">-scripts</span>/ifcfg<span class="literal">-ens33</span></span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=<span class="keyword">static</span>   //设置为静态</span><br><span class="line">DEFROUTE=yes</span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=yes</span><br><span class="line">IPV6_AUTOCONF=yes</span><br><span class="line">IPV6_DEFROUTE=yes</span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable<span class="literal">-privacy</span></span><br><span class="line">NAME=ens33</span><br><span class="line">UUID=e1d9fa74<span class="literal">-1031</span><span class="literal">-495e</span><span class="literal">-868d</span><span class="literal">-78b1739ee001</span></span><br><span class="line">DEVICE=ens33</span><br><span class="line">ONBOOT=yes		</span><br><span class="line">IPV6_PRIVACY=no</span><br><span class="line">IPADDR=<span class="number">192.168</span>.<span class="number">3.2</span></span><br><span class="line">PREFIX=<span class="number">255.255</span>.<span class="number">255.0</span></span><br><span class="line">GATEWAY=<span class="number">192.168</span>.<span class="number">3.1</span></span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">systemctl restart network     //重新启动网络 </span><br><span class="line">systemctl enable network 	  //加入开机自启动项</span><br><span class="line">systemctl stop firewalld.service	  //关闭防火墙</span><br><span class="line">systemctl disable firewalld.service   //关闭开机自启动</span><br><span class="line">chkconfig -<span class="literal">-list</span>			  //查看开机自启动项列表</span><br><span class="line">setenforce <span class="number">0</span>				  //关闭selinux</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">vi /etc/sysconfig/selinux		//修改selinux</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># This file controls the state of SELinux on the system.</span></span><br><span class="line"><span class="comment"># SELINUX= can take one of these three values:</span></span><br><span class="line"><span class="comment">#     enforcing - SELinux security policy is enforced.</span></span><br><span class="line"><span class="comment">#     permissive - SELinux prints warnings instead of enforcing.</span></span><br><span class="line"><span class="comment">#     disabled - No SELinux policy is loaded.</span></span><br><span class="line">SELINUX=disabled 		//关闭开机自启动</span><br><span class="line"><span class="comment"># SELINUXTYPE= can take one of three two values:</span></span><br><span class="line"><span class="comment">#     targeted - Targeted processes are protected,</span></span><br><span class="line"><span class="comment">#     minimum - Modification of targeted policy. Only selected processes are protected.</span></span><br><span class="line"><span class="comment">#     mls - Multi Level Security protection.</span></span><br><span class="line">SELINUXTYPE=targeted</span><br></pre></td></tr></table></figure></div>
<h2 id="2-安装服务"><a href="#2-安装服务" class="headerlink" title="2.安装服务"></a>2.安装服务</h2><h3 id="1-挂载光盘"><a href="#1-挂载光盘" class="headerlink" title="1).挂载光盘"></a>1).挂载光盘</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">mkdir /mnt/cdrom		//建立挂载点</span><br><span class="line">mount /dev/sr0 /mnt/cdrom/	//挂载</span><br></pre></td></tr></table></figure></div>
<h3 id="2-配置yum源"><a href="#2-配置yum源" class="headerlink" title="2).配置yum源"></a>2).配置yum源</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">cd /etc/yum.repos.d/	</span><br><span class="line">tar <span class="literal">-czvf</span> repo_bak *.repo	//备份原yum源</span><br><span class="line">vi CentOS7.repo		//新建本地yum源</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="type">CentOS7</span>]</span><br><span class="line">name=CentOS		//命名</span><br><span class="line">baseurl=file:///mnt/cdrom/		//iso镜像目录</span><br><span class="line">gpgcheck=<span class="number">0</span>				//是否进行安全校验</span><br><span class="line">enable=<span class="number">1</span>				//启动yum源</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum clean all    		//清除原yum缓存</span><br><span class="line">yum makecache			//新建yum缓存</span><br></pre></td></tr></table></figure></div>
<h3 id="3-配置DHCP服务"><a href="#3-配置DHCP服务" class="headerlink" title="3).配置DHCP服务"></a>3).配置DHCP服务</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum install dhcp		//安装dhcp服务</span><br><span class="line">vi /etc/dhcp/dhcpd.conf		//修改配置文件</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># DHCP Server Configuration file.</span></span><br><span class="line"><span class="comment">#   see /usr/share/doc/dhcp*/dhcpd.conf<span class="doctag">.example</span></span></span><br><span class="line"><span class="comment">#   see dhcpd.conf(5) man page</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">allow booting;		//允许dhcp服务给没有安装操作系统的服务器分配ip</span><br><span class="line">allow bootp;</span><br><span class="line">ddns<span class="literal">-update</span><span class="literal">-style</span> interim;</span><br><span class="line">ignore client<span class="literal">-updates</span>;</span><br><span class="line">subnet <span class="number">192.168</span>.<span class="number">3.0</span> netmask <span class="number">255.255</span>.<span class="number">255.0</span> &#123;</span><br><span class="line">        option subnet<span class="literal">-mask</span> <span class="number">255.255</span>.<span class="number">255.0</span>;</span><br><span class="line">        option domain<span class="literal">-name</span><span class="literal">-servers</span> <span class="number">192.168</span>.<span class="number">3.2</span>;</span><br><span class="line">        range   <span class="number">192.168</span>.<span class="number">3.100</span>   <span class="number">192.168</span>.<span class="number">3.200</span>;</span><br><span class="line">        dafault<span class="literal">-lease</span><span class="literal">-time</span> <span class="number">21600</span>;</span><br><span class="line">        next<span class="literal">-server</span> <span class="number">192.168</span>.<span class="number">3.2</span>;	</span><br><span class="line">        filename <span class="string">"pxelinux.0"</span>;		//	引导文件</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">systemctl restart dhcpd.service			//重启dhcp服务</span><br><span class="line">systemctl enable dhcpd.service			//加入开机自启动</span><br></pre></td></tr></table></figure></div>
<h3 id="4-配置TFTP服务-简单文本传输协议"><a href="#4-配置TFTP服务-简单文本传输协议" class="headerlink" title="4).配置TFTP服务(简单文本传输协议)"></a>4).配置TFTP服务<font size="3">(简单文本传输协议)</font></h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum install tftp<span class="literal">-server</span>		</span><br><span class="line">yum install xinetd		//安装依赖的xinetd服务</span><br><span class="line">vi /etc/xinetd.d/tftp</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># default: off</span></span><br><span class="line"><span class="comment"># description: The tftp server serves files using the trivial file transfer \</span></span><br><span class="line"><span class="comment">#       protocol.  The tftp protocol is often used to boot diskless \</span></span><br><span class="line"><span class="comment">#       workstations, download configuration files to network-aware printers, \</span></span><br><span class="line"><span class="comment">#       and to start the installation process for some operating systems.</span></span><br><span class="line">service tftp</span><br><span class="line">&#123;</span><br><span class="line">        socket_type             = dgram</span><br><span class="line">        protocol                = udp</span><br><span class="line">        wait                    = yes</span><br><span class="line">        user                    = root</span><br><span class="line">        server                  = /usr/sbin/in.tftpd</span><br><span class="line">        server_args             = <span class="literal">-s</span> /var/lib/tftpboot</span><br><span class="line">        disable                 = no 			//设置为no</span><br><span class="line">        per_source              = <span class="number">11</span></span><br><span class="line">        cps                     = <span class="number">100</span> <span class="number">2</span></span><br><span class="line">        flags                   = IPv4</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">systemctl restart xinetd.service </span><br><span class="line">systemctl enable xinetd.service</span><br></pre></td></tr></table></figure></div>
<h3 id="5-安装syslinux服务-开机获取引导文件"><a href="#5-安装syslinux服务-开机获取引导文件" class="headerlink" title="5).安装syslinux服务(开机获取引导文件)"></a>5).安装syslinux服务<font size="3">(开机获取引导文件)</font></h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum <span class="literal">-y</span> install syslinux</span><br></pre></td></tr></table></figure></div>
<h3 id="6-文件处理"><a href="#6-文件处理" class="headerlink" title="6).文件处理"></a>6).文件处理</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">cp <span class="literal">-a</span> /usr/share/syslinux/pxelinux.<span class="number">0</span>  /var/lib/tftpboot/		//复制引导文件</span><br><span class="line">cp <span class="literal">-a</span> /mnt/cdrom/images/pxeboot/initrd.img  /var/lib/tftpboot/</span><br><span class="line">cp <span class="literal">-a</span> /mnt/cdrom/images/pxeboot/vmlinuz  /var/lib/tftpboot/</span><br><span class="line">cp <span class="literal">-a</span> /mnt/cdrom/isolinux/boot.msg  /var/lib/tftpboot/</span><br><span class="line">cp <span class="literal">-a</span> /mnt/cdrom/isolinux/vesamenu.c32  /var/lib/tftpboot/</span><br><span class="line">mkdir /var/lib/tftpboot/pxelinux.cfg</span><br><span class="line">cp <span class="literal">-a</span> /mnt/cdrom/isolinux/isolinux.cfg  /var/lib/tftpboot/pxelinux.cfg/default  //更改文件名为“default”</span><br><span class="line">vi /var/lib/tftpboot/pxelinux.cfg/default</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">default linux    		//添加引导选项</span><br><span class="line"><span class="comment">#default vesamenu.c32   //注释掉</span></span><br><span class="line">timeout <span class="number">600</span></span><br><span class="line">display boot.msg</span><br><span class="line">			.......</span><br><span class="line">label linux</span><br><span class="line">  menu label ^Install CentOS <span class="number">7</span></span><br><span class="line">  kernel vmlinuz</span><br><span class="line">  append initrd=initrd.img  ks=http://<span class="number">192.168</span>.<span class="number">3.2</span>/ks.cfg		//添加引导信息</span><br><span class="line"><span class="comment">#append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 quiet	//注释</span></span><br><span class="line">			.......</span><br></pre></td></tr></table></figure></div>
<h3 id="7-配置http服务"><a href="#7-配置http服务" class="headerlink" title="7).配置http服务"></a>7).配置http服务</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum install httpd</span><br><span class="line">cp <span class="literal">-a</span> /root/anaconda<span class="literal">-ks</span>.cfg    /var/www/html/ks.cfg</span><br><span class="line">vi ks.cfg</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment">#version=DEVEL</span></span><br><span class="line"><span class="comment"># System authorization information</span></span><br><span class="line">auth -<span class="literal">-enableshadow</span> -<span class="literal">-passalgo</span>=sha512</span><br><span class="line"><span class="comment"># Use CDROM installation media</span></span><br><span class="line">url  -<span class="literal">-url</span>=http://<span class="number">192.168</span>.<span class="number">3.2</span>/cdrom       //添加镜像地址</span><br><span class="line"><span class="comment"># Use graphical install</span></span><br><span class="line">graphical</span><br><span class="line">		......</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">chown apache:apache ks.cfg					//修改ks.cfg文件组和属组为apache</span><br><span class="line">mkdir /var/www/html/cdrom					//建立挂载点</span><br><span class="line">mount /dev/sr0 /var/www/html/cdrom			//挂载</span><br><span class="line">systemctl restart httpd.service				//重新启动服务</span><br><span class="line">systemctl enable httpd.service				//加入开机自启动</span><br></pre></td></tr></table></figure></div>
<h2 id="3-客户端测试"><a href="#3-客户端测试" class="headerlink" title="3.客户端测试"></a>3.客户端测试</h2><p><font size="4">1).设置网络连接方式为“仅主机”<br> 2).CentOS7.3 以上内存必须要大于2G<br> 3).CD里面不放镜像，直接开机</font><br><a href="https://img-blog.csdnimg.cn/20200220215626217.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200220215626217.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a></p>
<h1 id="成功！！！"><a href="#成功！！！" class="headerlink" title="成功！！！"></a>成功！！！</h1>]]></content>
  </entry>
  <entry>
    <title>Liunx—搭建DHCP服务器</title>
    <url>/2020/02/18/Liunx%E2%80%94%E6%90%AD%E5%BB%BADHCP%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Linux搭建DHCP服务器"><a href="#Linux搭建DHCP服务器" class="headerlink" title="Linux搭建DHCP服务器 "></a><center>Linux搭建DHCP服务器 </center></h1><h5 id="准备："><a href="#准备：" class="headerlink" title="准备："></a>准备：</h5><p><font size="4">以虚拟Linux主机作为服务端，虚拟Windows主机作为客户端，所以两台主机都以“仅主机模式”的网络连接方式进行连接：</font><br><a href="https://img-blog.csdnimg.cn/20200218213720814.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70#pic_center=30*30" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200218213720814.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70#pic_center=30*30" class="lazyload" title="在这里插入图片描述"></a></p>
<h2 id="1-服务端配置"><a href="#1-服务端配置" class="headerlink" title="1.服务端配置"></a>1.服务端配置</h2><h3 id="1-安装DHCP服务"><a href="#1-安装DHCP服务" class="headerlink" title="1).安装DHCP服务"></a>1).安装DHCP服务</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum install dhcp</span><br></pre></td></tr></table></figure></div>
<h3 id="2-配置DHCP服务的主配置文件"><a href="#2-配置DHCP服务的主配置文件" class="headerlink" title="2).配置DHCP服务的主配置文件"></a>2).配置DHCP服务的主配置文件</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">vi /etc/dhcp/dhcpd.conf					//这是dhcp的主要配置文件（默认为空）</span><br><span class="line">cp /usr/share/doc/dhcp<span class="literal">-4</span>.<span class="number">2.5</span>/dhcpd.conf.example /etc/dhcp/dhcp.conf		//将dhcp的模板文件替换成主配置文件</span><br></pre></td></tr></table></figure></div>
<h3 id="3-编辑主配置文件"><a href="#3-编辑主配置文件" class="headerlink" title="3).编辑主配置文件"></a>3).编辑主配置文件</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">subnet <span class="number">192.170</span>.<span class="number">70.0</span>  netmask <span class="number">255.255</span>.<span class="number">255.0</span> &#123;     		//声明网段，子网掩码</span><br><span class="line">  range <span class="number">192.170</span>.<span class="number">70.1</span> <span class="number">192.170</span>.<span class="number">70.200</span>;					//地址池分配地址范围</span><br><span class="line">  option domain<span class="literal">-name</span><span class="literal">-servers</span> <span class="number">192.170</span>.<span class="number">70.137</span>;		 	//分配的dns服务器地址</span><br><span class="line">  option domain<span class="literal">-name</span> <span class="string">"test.cn"</span>;					 		//分配的域名</span><br><span class="line">  option routers <span class="number">172.170</span>.<span class="number">70.137</span>;					 	//设置网关</span><br><span class="line">  default<span class="literal">-lease</span><span class="literal">-time</span> <span class="number">600</span>;						 		//缺省（默认）租约时间</span><br><span class="line">  max<span class="literal">-lease</span><span class="literal">-time</span> <span class="number">7200</span>;							 		//最大租约时间</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h3 id="4-重启DHCP服务"><a href="#4-重启DHCP服务" class="headerlink" title="4).重启DHCP服务"></a>4).重启DHCP服务</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">systemctl restart dhcpd.service</span><br></pre></td></tr></table></figure></div>
<h3 id="5-查看端口状态"><a href="#5-查看端口状态" class="headerlink" title="5).查看端口状态"></a>5).查看端口状态</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">netstat <span class="literal">-anput</span> | grep <span class="number">67</span></span><br><span class="line">udp        <span class="number">0</span>      <span class="number">0</span> <span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">67</span>              <span class="number">0.0</span>.<span class="number">0.0</span>:*                           <span class="number">3592</span>/dhcpd </span><br><span class="line">//dhcp使用的是c/s传输模式，所以查看upd协议的<span class="number">67</span>号端口</span><br></pre></td></tr></table></figure></div>
<h2 id="2-客户端配置"><a href="#2-客户端配置" class="headerlink" title="2.客户端配置"></a>2.客户端配置</h2><h4 id="1-将网卡设置为自动获取ip地址："><a href="#1-将网卡设置为自动获取ip地址：" class="headerlink" title="1).将网卡设置为自动获取ip地址："></a>1).将网卡设置为自动获取ip地址：</h4><p><a href="https://img-blog.csdnimg.cn/20200218222737536.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200218222737536.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a></p>
<h4 id="2-释放ip地址"><a href="#2-释放ip地址" class="headerlink" title="2).释放ip地址"></a>2).释放ip地址</h4><p><a href="https://img-blog.csdnimg.cn/20200218223420263.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200218223420263.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a></p>
<h4 id="3-从主机重新获取ip"><a href="#3-从主机重新获取ip" class="headerlink" title="3).从主机重新获取ip"></a>3).从主机重新获取ip</h4><p><a href="https://img-blog.csdnimg.cn/20200218223651137.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200218223651137.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a><br><font size="4">已经获取到了dhcp服务器动态分配的地址</font></p>
<h2 id="3-客户端分配静态的ip地址"><a href="#3-客户端分配静态的ip地址" class="headerlink" title="3.客户端分配静态的ip地址"></a>3.客户端分配静态的ip地址</h2><h4 id="1-找到网卡的MAC地址："><a href="#1-找到网卡的MAC地址：" class="headerlink" title="1).找到网卡的MAC地址："></a>1).找到网卡的MAC地址：</h4><p><a href="https://img-blog.csdnimg.cn/20200218225129298.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200218225129298.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a></p>
<h4 id="2-修改服务端的配置文件："><a href="#2-修改服务端的配置文件：" class="headerlink" title="2).修改服务端的配置文件："></a>2).修改服务端的配置文件：</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">vi /etc/dhcp/dhcpd.conf</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">host fantasia &#123;				//文件内能找到</span><br><span class="line">  hardware ethernet <span class="number">00</span><span class="literal">-0C</span><span class="literal">-29</span><span class="literal">-8D</span><span class="literal">-49</span><span class="literal">-0C</span>;		//客户端的MAC地址</span><br><span class="line">  fixed<span class="literal">-address</span> <span class="number">192.168</span>.<span class="number">70.140</span>;				//给客户端分配的静态ip</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h4 id="3-客户端进行测试"><a href="#3-客户端进行测试" class="headerlink" title="3).客户端进行测试"></a>3).客户端进行测试</h4><p><a href="https://img-blog.csdnimg.cn/20200218230112365.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200218230112365.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload" title="在这里插入图片描述"></a></p>
<h1 id="成功！！！"><a href="#成功！！！" class="headerlink" title="成功！！！"></a>成功！！！</h1>]]></content>
  </entry>
  <entry>
    <title>Linux—搭建DNS服务器</title>
    <url>/2020/02/08/Linux%E2%80%94%E6%90%AD%E5%BB%BADNS%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Linux搭建DNS服务器教程"><a href="#Linux搭建DNS服务器教程" class="headerlink" title="Linux搭建DNS服务器教程"></a><center>Linux搭建DNS服务器教程</center></h1><h2 id="1-安装bind"><a href="#1-安装bind" class="headerlink" title="1.安装bind"></a>1.安装bind</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum install bind</span><br></pre></td></tr></table></figure></div>

<h2 id="2-修改named-conf配置文件"><a href="#2-修改named-conf配置文件" class="headerlink" title="2.修改named.conf配置文件"></a>2.修改named.conf配置文件</h2><p><font size="4">vi /etc/named.conf 下的</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">options &#123;</span><br><span class="line">       listen<span class="literal">-on</span> port <span class="number">53</span> &#123; any; &#125;; //所有服务都能监听<span class="number">53</span>这个端口</span><br><span class="line">       listen<span class="literal">-on</span><span class="literal">-v6</span> port <span class="number">53</span> &#123; ::<span class="number">1</span>; &#125;;</span><br><span class="line">       directory       <span class="string">"/var/named"</span>;</span><br><span class="line">       dump<span class="operator">-file</span>       <span class="string">"/var/named/data/cache_dump.db"</span>;</span><br><span class="line">       statistics<span class="operator">-file</span> <span class="string">"/var/named/data/named_stats.txt"</span>;</span><br><span class="line">       memstatistics<span class="operator">-file</span> <span class="string">"/var/named/data/named_mem_stats.txt"</span>;</span><br><span class="line">       recursing<span class="operator">-file</span>  <span class="string">"/var/named/data/named.recursing"</span>;</span><br><span class="line">       secroots<span class="operator">-file</span>   <span class="string">"/var/named/data/named.secroots"</span>;</span><br><span class="line">       allow<span class="literal">-query</span>     &#123; any; &#125;; //表示所有人都可以访问这台dns服务器</span><br><span class="line">       forwarders		&#123; <span class="number">192.168</span>.<span class="number">19.140</span>; &#125;; //添加后，本地dns主机解析外网网站</span><br></pre></td></tr></table></figure></div>
<p><font size="3">测试配置是否正确：</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">named<span class="literal">-checkconf</span> /etc/named.conf</span><br></pre></td></tr></table></figure></div>

<h2 id="3-配置named-rfc1912-zones文件"><a href="#3-配置named-rfc1912-zones文件" class="headerlink" title="3.配置named.rfc1912.zones文件"></a>3.配置named.rfc1912.zones文件</h2><p><font size="3">添加正向解析: </font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">zone <span class="string">"test.com"</span> <span class="keyword">IN</span> &#123;	//域名	</span><br><span class="line">        type master;	//服务类型：主服务器</span><br><span class="line">        file <span class="string">"test.com.zone"</span>;  //域名与ip地址解析规则保存文件</span><br><span class="line">        allow<span class="literal">-update</span> &#123; none; &#125;; //允许那些客户机动态更新解析信息</span><br><span class="line">&#125;;	//结尾分号不能少</span><br></pre></td></tr></table></figure></div>
<p><font size="3">添加反向解析: </font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">zone <span class="string">"0.17.172.in-addr.arpa"</span> <span class="keyword">IN</span> &#123;	//表示<span class="number">172.17</span>.<span class="number">0.0</span>/<span class="number">24</span>网段的反向解析区域</span><br><span class="line">        type master;</span><br><span class="line">        file <span class="string">"172.17.0.local"</span>;</span><br><span class="line">        allow<span class="literal">-update</span> &#123; none; &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>
<h2 id="4-编辑正向-反向解析配置文件"><a href="#4-编辑正向-反向解析配置文件" class="headerlink" title="4.编辑正向/反向解析配置文件"></a>4.编辑正向/反向解析配置文件</h2><h3 id="（1）在-var-named-下分别建立-test-com-zone-和172-17-0-local-文件"><a href="#（1）在-var-named-下分别建立-test-com-zone-和172-17-0-local-文件" class="headerlink" title="（1）在/var/named/下分别建立 test.com.zone 和172.17.0.local 文件"></a>（1）在/var/named/下分别建立 test.com.zone 和172.17.0.local 文件</h3><p>可直接：<br><font size="3">cp -p named.localhost    test.com.zone<br>cp -p named.loopback  172.17.0.local </font></p>
<h3 id="（2）编辑test-com-zone："><a href="#（2）编辑test-com-zone：" class="headerlink" title="（2）编辑test.com.zone："></a>（2）编辑test.com.zone：</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$TTL</span> <span class="number">1</span>D		//生存周期为<span class="number">1</span>天</span><br><span class="line"><span class="selector-tag">@</span>       <span class="keyword">IN</span> SOA  www.test.com.   root.test.com.(		</span><br><span class="line">                                        <span class="number">0</span>       ; serial	//更新序列号</span><br><span class="line">                                        <span class="number">1</span>D      ; refresh	//更新时间</span><br><span class="line">                                        <span class="number">1</span>H      ; retry		//重试时间</span><br><span class="line">                                        <span class="number">1</span>W      ; expire	//失效时间</span><br><span class="line">                                        <span class="number">3</span>H )    ; minimum	//无效解析记录的缓存时间</span><br><span class="line">        <span class="keyword">IN</span>      NS      www.test.com.</span><br><span class="line">www     <span class="keyword">IN</span>      A       <span class="number">172.17</span>.<span class="number">0.1</span>	//正向解析</span><br><span class="line">ftp     <span class="keyword">IN</span>      A       <span class="number">172.17</span>.<span class="number">0.2</span></span><br></pre></td></tr></table></figure></div>
<h3 id="（3）编辑172-17-0-local："><a href="#（3）编辑172-17-0-local：" class="headerlink" title="（3）编辑172.17.0.local："></a>（3）编辑172.17.0.local：</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$TTL</span> <span class="number">1</span>D</span><br><span class="line"><span class="selector-tag">@</span>       <span class="keyword">IN</span> SOA  www.test.com    root.test.com. (</span><br><span class="line">                                        <span class="number">0</span>       ; serial</span><br><span class="line">                                        <span class="number">1</span>D      ; refresh</span><br><span class="line">                                        <span class="number">1</span>H      ; retry</span><br><span class="line">                                        <span class="number">1</span>W      ; expire</span><br><span class="line">                                        <span class="number">3</span>H )    ; minimum</span><br><span class="line">        <span class="keyword">IN</span>      NS      www.test.com.</span><br><span class="line"><span class="number">1</span>       <span class="keyword">IN</span>      PTR     www.test.com.	//反向解析</span><br><span class="line"><span class="number">2</span>       <span class="keyword">IN</span>      PTR     ftp.test.com.</span><br></pre></td></tr></table></figure></div>

<p><font size="3">测试配置是否正确：</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">named<span class="literal">-checkconf</span> /var/named/test.com.zone</span><br><span class="line">named<span class="literal">-checkconf</span> /var/named/<span class="number">172.17</span>.<span class="number">0</span>.local</span><br></pre></td></tr></table></figure></div>
<h2 id="5-添加本地DNS"><a href="#5-添加本地DNS" class="headerlink" title="5.添加本地DNS"></a>5.添加本地DNS</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">; generated by /usr/sbin/dhclient<span class="literal">-script</span></span><br><span class="line">nameserver <span class="number">172.17</span>.<span class="number">0.15</span>		//新建DNS服务器地址（本地ip）查询优先级自上而下</span><br><span class="line">nameserver <span class="number">183.60</span>.<span class="number">83.19</span>		</span><br><span class="line">nameserver <span class="number">183.60</span>.<span class="number">82.98</span></span><br></pre></td></tr></table></figure></div>
<p><font size="3"> 重启dns服务：</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">sysytemctl	restart	named.service</span><br></pre></td></tr></table></figure></div>

<h2 id="6-通过nslookup进行解析"><a href="#6-通过nslookup进行解析" class="headerlink" title="6.通过nslookup进行解析"></a>6.通过nslookup进行解析</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">16</span>:<span class="number">21</span>:<span class="number">08</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> nslookup</span><br><span class="line">&gt; www.test.com</span><br><span class="line">Server:		<span class="number">172.17</span>.<span class="number">0.15</span></span><br><span class="line">Address:	<span class="number">172.17</span>.<span class="number">0.15</span></span><br><span class="line"></span><br><span class="line">Name:	www.test.com</span><br><span class="line">Address: <span class="number">172.17</span>.<span class="number">0.1</span></span><br><span class="line">&gt; <span class="number">172.17</span>.<span class="number">0.2</span></span><br><span class="line"><span class="number">2.0</span>.<span class="number">17.172</span>.in<span class="literal">-addr</span>.arpa	name = ftp.test.com.</span><br></pre></td></tr></table></figure></div>
<h1 id="成功！！！"><a href="#成功！！！" class="headerlink" title="成功！！！"></a>成功！！！</h1>]]></content>
  </entry>
</search>
